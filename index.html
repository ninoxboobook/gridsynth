<!DOCTYPE html>
<html>

<head>
    <title>gridsynth - Sonifying the electricity grid</title>
    <link rel="stylesheet" href="/css/style.css">
    <script src="/js/main.js"></script>
    <script src="/js/data.js"></script>
    <script src="/js/controls.js"></script>
    <script src="/js/instruments.js"></script>
</head>

<body>
    <div id="p5-wrapper">
        <script>
            let backgroundDesktop;
            let backgroundTablet;
            let backgroundMobile;

            function preload() {
                backgroundDesktop = loadImage('/assets/gridsynth-bg-desktop.png');
                backgroundTablet = loadImage('/assets/gridsynth-bg-tablet.png');
                backgroundMobile = loadImage('/assets/gridsynth-bg-mobile.png');
            }

            function setup() {
                var canvas = createCanvas(windowWidth, windowHeight);
                canvas.parent("p5-wrapper");
            }
            var coalVolHistory = [];

            function draw() {
                let coalVol = coal.volume.value;
                coalVolHistory.push(coalVol);
                if (windowWidth < 480) {
                    background(backgroundMobile);
                } else if (windowWidth >= 480 && windowWidth < 768) {
                    background(backgroundTablet);
                } else {
                    background(backgroundDesktop);
                }
                stroke(0);
                noFill();
                beginShape();
                for (var i = 0; i < coalVolHistory.length; i++) {
                    let y = map(coalVolHistory[i], -9, -30, (height / 2), (0 + height / 4));
                    vertex(i, y);
                }
                endShape();
                if (coalVolHistory.length > width) {
                    coalVolHistory.splice(0, 1);
                }
            }

            function windowResized() {
                resizeCanvas(windowWidth, windowHeight);
            }
        </script>
    </div>
    <div id="content-wrapper">
        <div class="content">
            <h1 class="display">Gridsynth</h1>
            <button id="play-button" class="emphasis">Play</button>
            <button id="stop-button">Stop</button>
        </div>
    </div>

    <script src="/js/gridsynth.js"></script>
</body>

</html>